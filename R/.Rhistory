library(FLCore)
library(FLash)
source('../R/mseFuncs.R')
ls()
my.dir<-"../"
source(paste(my.dir,"R/mseFuncs.R",sep=""))
cod4.2010            <-read.FLStock(paste(my.dir,"input/cod6a.IDX",    sep=""))
cod4.2010 <-readFLStock(paste(my.dir,"input/cod6a.IDX", sep=""))
plot(cod4.2010)
cod4.2010@catch.n
cod4.2010@landings.n
readVPAFile(paste(my.dir,"input/Cod6aLN.DAT",sep=""))
cod4.2010@catch.wt
cod4.2010@landings.wt
cod4.2010 <-read.FLStock(paste(my.dir,"input/cod6a.IDX",sep=""))
cod4.2010 <-readFLStock(paste(my.dir,"input/cod6a.IDX",sep=""))
plot(cod4.2010)
ls()
read.VPAFile(paste(my.dir,"input/Cod6aCN.DAT",sep=""))
readVPAFile(paste(my.dir,"input/Cod6aCN.DAT",sep=""))
args(readVPAFile)
readVPAFile(paste(my.dir,"input/Cod6aCN.DAT",sep=""), quite=FALSE)
paste(my.dir, "input/Cod6aCN.DAT", sep = "")
readVPAFile(paste(my.dir,"input/Cod6aCN.DAT",sep=""))
readVPAFi
readVPAFile
readVPAFile(paste(my.dir,"input/Cod6aCN.DAT",sep=""), quite=FALSE)
debug(readVPAFile)
readVPAFile(paste(my.dir,"input/Cod6aCN.DAT",sep=""), quite=FALSE)
readVPAFile(paste(my.dir,"input/Cod6aCN.DAT",sep=""))
readVPAFile(paste(my.dir,"input/Cod6aCN.DAT",sep=""), quite=FALSE)
readVPAFile(paste(my.dir,"input/Cod6aCN.DAT",sep=""), quiet=FALSE)
undebug(readVPAFile)
catch.n(cod4.2010) <- readVPAFile(paste(my.dir,"input/cod6aCN.DAT",sep=""), quiet=FALSE)
catch.wt(cod4.2010) <- readVPAFile(paste(my.dir,"input/cod6aCW.DAT",sep=""), quiet=FALSE)
discards.n(cod4.2010) <- readVPAFile(paste(my.dir,"input/cod6aDN.DAT",sep=""), quiet=FALSE)
discards.wt(cod4.2010) <- readVPAFile(paste(my.dir,"input/cod6aDW.DAT",sep=""), quiet=FALSE)
plot(cod4.2010)
catch.n(cod4.2010)
landings.n(cod4.2010)
catch.n(cod4.2010)
plot(cod4.2010)
range(cod4.2010,c("minfbar","maxfbar"))<-c(2,5)
cod4.2010 <-setPlusGroup(cod4.2010 ,7, na.rm=TRUE)
f.hat <-read.table(paste(my.dir,"Badapt used for MSE/F.csv",sep=""),header=FALSE,sep=",") [,-c(1,35)]
f.hat <-read.table(paste(my.dir,"Badapt used for MSE/F.CSV",sep=""),header=FALSE,sep=",") [,-c(1,35)]    ### changed MPH
n.hat <-read.table(paste(my.dir,"Badapt used for MSE/NUMBERS.CSV",sep=""),header=FALSE,sep=",") [,-c(1,35,36)]    ### changed MPH
f.hat
dim(f.hat)
cbind(data=as.numeric(as.matrix(f.hat)),dmns)
dmns <- expand.grid(age=1:7,iter=0:1000,year=1978:2010)                                                           ### 
dnms
dmns
head(cbind(data=as.numeric(as.matrix(f.hat)),dmns))
harvest(cod4.2010) <- as.FLQuant(cbind(data=as.numeric(as.matrix(f.hat)),dmns),units="f")
harvest(cod4.2010) <- as.FLQuant(cbind(data=as.numeric(as.matrix(f.hat)),dmns),units="f")
stock.n(cod4.2010) <- as.FLQuant(cbind(data=as.numeric(as.matrix(n.hat)),dmns))                     ### changed MPH
rm(f.hat,n.hat)
dimnames(harvest(cod4.2010))
is(harvest(cod4.2010))
plot(FLStocks(window(iter(cod4.2010,2:1001), end=2010),
              window(iter(cod4.2010,1),      end=2010)),ylab="Year")
jpeg(paste(my.dir,"/data/KeyRun.jpeg",sep=""))
plot(FLStocks(window(iter(cod4.2010,2:1001), end=2010),
              window(iter(cod4.2010,1),      end=2010)),ylab="Year")
dev.off()
cod4.sr <- as.FLSR(window(iter(cod4.2010,1), end=2010), model='ricker')
plot(cod4.sr)
cod4.sr <- mle(cod4.sr)
cod4.sr <- fmle(cod4.sr)
plot(cod4.sr)
jpeg(file=paste(my.dir,"/data/SR.jpeg",sep=""))
plot(cod4.sr)
dev.off()
cod4.2010 <- iter(cod4.2010,2:1001)
params(cod4.sr)
srPar <- params(cod4.sr)
exp(rnorm(20000)*.66)
exp((-0.66^2)/2)
sr.deviates <- FLQuant(exp(rnorm(20000)*.66), dimnames=list(age=1,year=2011:2030,iter=1:1000))*exp((-0.66^2)/2)
plot(sr.deviates)
summary(rnorm(20000)*.66)
sd(rnorm(20000)*.66)
var(rnorm(20000)*.66)
sd(rnorm(20000, sd=.66))
sd(rnorm(20000, sd=.66))
sd(rnorm(20000, sd=.66))
sd(rnorm(20000, sd=.66))
sd(rnorm(20000, sd=.66))
sd(rnorm(20000, sd=.66))
sr.deviates <- FLQuant(rlnorm(20000, sd=0.66), dimnames=list(age=1,year=2011:2030,iter=1:1000))
plot(sr.deviates)
exp(0.66)
save(srPar,file=paste(my.dir,"/data/condSR.RData",sep=""))
cod4 <- stf(cod4.2010,nyrs=20)
library(FLAssess)
cod4 <- stf(cod4.2010,nyrs=20)
cod4 <- stf(cod4.2010, nyrs=20)
args(stf)
stf
showMethods("stf")
showMethods("stf", includeDefs=TRUE)
cod4 <- stf(cod4.2010,nyears=20)
plot(cod4)
trgt <-fwdTarget(year=2011:2030,quantity="f",value=0.4)
trgt <-fwdControl(year=2011:2030,quantity="f",value=0.4)
trgt <- fwdControl(year=2011:2030, quantity="f", value=0.4)
?fwdControl
fwdControl(year=2011:2030, quantity="f", value=0.4)
fwdControl(data.frame(year=2011:2030, quantity="f", value=0.4))
trgt <-fwdTarget(data.frame(year=2011:2030,quantity="f",val=0.4))
trgt <-fwdControl(data.frame(year=2011:2030,quantity="f",val=0.4))
trgt
srPar
cod4.sr
cod4 <- fwd(cod4, trgt, sr=cod4.sr, sr.residuals=sr.deviates)
plot(cod4)
params(cod4.2.sr)[,"a"]
cod4.2.sr <- cod4.sr 
params(cod4.2.sr)[,"a"]
params(cod4.2.sr)["a"]
cod4.2.sr <- cod4.sr 
params(cod4.2.sr)["a"] <- params(cod4.2.sr)["a"]/2
cod4.2 <- fwd(cod4, trgt, sr=cod4.2.sr, sr.residuals=sr.deviates)
x11()
plot(cod4.2)
plot(cod4.2)
plot(cod4.2.sr)
x11()
plot(cod4.sr)
dev.off()
dev.off()
dev.off()
dev.off()
plot(FLStocks(cod4,cod4.2))
jpeg(file=paste(my.dir,"/data/ProjSRs.jpeg",sep=""))
plot(FLStocks(cod4,cod4.2))
dev.off()
computeCatch.n(window(cod4.2010,end=2010))
computeCatch.n
catchMisrep <- computeCatch.n(window(cod4.2010,end=2010))
histogram( ~ data | as.character(year), data = as.data.frame(window(catchMisrep/catch.n(cod4.2010),start=1994)), xlab="Mis-reporting Ratio")
cod4.Catch <- window(cod4.2010,end=2010)
catch.n(cod4.Catch) <- computeCatch.n(cod4.Catch)
landings.n(cod4.Catch) <- catch.n(cod4.Catch)*landings.n(cod4.Catch)/(discards.n(cod4.Catch)+landings.n(cod4.Catch))
discards.n(cod4.Catch) <- catch.n(cod4.Catch)-landings.n(cod4.Catch)
computeStock(cod4.Catch)
stock(cod4.Catch) <- computeStock(cod4.Catch)
computeCatch(cod4.Catch, "all")
catch.wt(cod4.2010)
computeCatch(cod4.Catch, "all")$catch.wt
computeCatch(cod4.Catch, "all")$catch.wt - catch.wt(cod4.Catch)
mean(computeCatch(cod4.Catch, "all")$catch.wt - catch.wt(cod4.Catch))
summary(computeCatch(cod4.Catch, "all")$catch.wt - catch.wt(cod4.Catch))
catch(cod4.Catch) <- computeCatch(cod4.Catch, "all")
landings(cod4.Catch) <- computeLandings(cod4.Catch)
discards(cod4.Catch) <- computeDiscards(cod4.Catch)
plot(cod4.Catch)
plot(FLStocks(cod4.2010, cod4.Catch))
plot(FLStocks(cod4, cod4.Catch))
cod4.Catch <- window(cod4.2010,end=2010)
catch.n(cod4.Catch) <- computeCatch.n(cod4.Catch)
landings.n(cod4.Catch) <- catch.n(cod4.Catch)*landings.n(cod4.Catch)/(discards.n(cod4.Catch)+landings.n(cod4.Catch))
discards.n(cod4.Catch) <- catch.n(cod4.Catch)-landings.n(cod4.Catch)
stock(cod4.Catch) <- computeStock(cod4.Catch)
catch(cod4.Catch) <- computeCatch(cod4.Catch, "all")
landings(cod4.Catch) <- computeLandings(cod4.Catch)
discards(cod4.Catch) <- computeDiscards(cod4.Catch)
cod4.M <- window(cod4.2010,end=2010)
m(cod4.M) <- sweep(harvest(cod4.M)*sweep(catchMisrep,c(1:2), catch.n(cod4.M), "-")/catchMisrep , 1:2, m(cod4.M), "+")
m(cod4.M)
m(cod4)
m(cod4.M)
cod4.M <- window(cod4.2010,end=2010)
m(cod4.M) <- sweep(harvest(cod4.M)*sweep(catchMisrep,c(1:2), catch.n(cod4.M), "-")/catchMisrep , 1:2, m(cod4.M), "+")
harvest(cod4.M) <- sweep(harvest(cod4.M)-m(cod4.M),1:2,m(cod4.Catch),"+")
units(harvest(cod4.M)) <- "f"
stock(cod4.M) <- computeStock(cod4.M)
catch(cod4.M) <- computeCatch(cod4.M,"all")
landings(cod4.M) <- computeLandings(cod4.M)
discards(cod4.M) <- computeDiscards(cod4.M)
plot(FLStocks(cod4, cod4.Catch, cod4.M))
plot(FLStocks(cod4, cod4.M))
plot(cod4)
plot(FLStocks(cod4, cod4.M))
plot(FLQuants(m(cod4), m(cod4.M)))
plot(FLQuants(m(cod4), m(cod4.M))
)
xyplot(data~year|age, data=FLQuants(m(cod4), m(cod4.M)))
xyplot(data~year|age, groups=qname, data=FLQuants(m(cod4), m(cod4.M)))
xyplot(data~year|age, data=m(cod4.M))
q()
